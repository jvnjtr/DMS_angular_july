import { Injectable } from '@angular/core';
import * as CryptoJS from 'crypto-js';
import { Buffer } from 'buffer';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "@angular/common/http";
import * as i3 from "./varlist.service";
export class MsgengineLibService {
    constructor(router, http, varlist) {
        this.router = router;
        this.http = http;
        this.varlist = varlist;
    }
    directlogoutlib() {
        sessionStorage.removeItem('ADMIN_SESSION');
        sessionStorage.removeItem('TOKEN');
        this.router.navigateByUrl('/login');
    }
    getGetwayName(formParams) {
        let requestParam = Buffer.from(JSON.stringify(formParams), 'utf8').toString('base64');
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceURL = this.varlist.serviceURL + '/getwayConfiguration';
        let desnResponse = this.http.post(serviceURL, reqData);
        return desnResponse;
    }
    viewGatwayTypes(formParams) {
        let requestParam = Buffer.from(JSON.stringify(formParams), 'utf8').toString('base64');
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceURL = this.varlist.serviceURL + '/getwayType';
        let desnResponse = this.http.post(serviceURL, reqData);
        return desnResponse;
    }
    newGetwayConfig(docParams) {
        let requestParam = btoa(JSON.stringify(docParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/insertGatewayConfiguration';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    viewGetwayConfig(docParams) {
        let requestParam = btoa(JSON.stringify(docParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/viewConfiguration';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    getPrevDetails(docParams) {
        let requestParam = btoa(JSON.stringify(docParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/fillAll';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    deleteGetwayConfig(docParams) {
        let requestParam = btoa(JSON.stringify(docParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/deletegetwayDocument';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    deleteAll(formParams, fname) {
        let requestParam = btoa(JSON.stringify(formParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = {
            REQUEST_DATA: requestParam,
            REQUEST_TOKEN: requestToken
        };
        let serviceUrl = this.varlist.serviceURL + fname;
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    publishAll(formParams, fname) {
        let requestParam = btoa(JSON.stringify(formParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = {
            REQUEST_DATA: requestParam,
            REQUEST_TOKEN: requestToken
        };
        let serviceUrl = this.varlist.serviceURL + fname;
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    unpublishAll(formParams, fname) {
        let requestParam = btoa(JSON.stringify(formParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = {
            REQUEST_DATA: requestParam,
            REQUEST_TOKEN: requestToken
        };
        let serviceUrl = this.varlist.serviceURL + fname;
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    newMessage(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/addMessageConfig';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    // newMessage(messageParams: any): Observable<any> {
    //   let serviceUrl = this.varlist.serviceURL + 'addMessageConfig';
    //   let serviceRes = this.http.post(serviceUrl, messageParams);
    //   return serviceRes;
    // }
    viewMessage(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/viewMessageConfig';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    reminderSchedular(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/getRemindercron';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    msgexecuteSchedular(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/startExecution';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    msgstopSchedular(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/stopExecution';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getStaticConfigurationKeys(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/GetStaticKeys';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getFetchPublishRecord(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/FetchPublishRecord';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getLanguage(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/viewLanguage';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getForms(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/getFormName';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getConfigurationKeys(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/getConfigKeys';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    msguploadFile(formParams) {
        let serviceURL = this.varlist.serviceURL + '/fileUpload';
        let moduleResponse = this.http.post(serviceURL, formParams);
        return moduleResponse;
    }
    langReplace(languageText, languageName = "") {
        if (languageText != "" && languageText != undefined) {
            let lngToLower = languageText.toLowerCase();
            let allLangListResult = sessionStorage.getItem("ALL_LANG_LIST");
            let SeetionParsedLangRes = JSON.parse(CryptoJS.AES.decrypt(allLangListResult, this.varlist.apiHashingKey).toString(CryptoJS.enc.Utf8));
            let sessionUserLangtoken = sessionStorage.getItem("USER_LANGPREF");
            let sessionUserLang = JSON.parse(CryptoJS.AES.decrypt(sessionUserLangtoken, this.varlist.apiHashingKey).toString(CryptoJS.enc.Utf8));
            if (SeetionParsedLangRes[lngToLower] != undefined) {
                let allParsedLang = JSON.parse(SeetionParsedLangRes[lngToLower]);
                return allParsedLang[sessionUserLang] != "" && allParsedLang[sessionUserLang] != undefined
                    ? allParsedLang[sessionUserLang]
                    : languageText;
            }
            else {
                return languageText;
            }
        }
        else {
            return languageText;
        }
    }
}
MsgengineLibService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: MsgengineLibService, deps: [{ token: i1.Router }, { token: i2.HttpClient }, { token: i3.VarlistService }], target: i0.ɵɵFactoryTarget.Injectable });
MsgengineLibService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: MsgengineLibService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: MsgengineLibService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: function () { return [{ type: i1.Router }, { type: i2.HttpClient }, { type: i3.VarlistService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXNnZW5naW5lLWxpYi5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbXNnZW5naW5lLWxpYi9zcmMvbGliL21zZ2VuZ2luZS1saWIuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSzNDLE9BQU8sS0FBSyxRQUFRLE1BQU0sV0FBVyxDQUFDO0FBRXRDLE9BQU8sRUFBQyxNQUFNLEVBQUMsTUFBTSxRQUFRLENBQUM7Ozs7O0FBUzlCLE1BQU0sT0FBTyxtQkFBbUI7SUFLOUIsWUFDVSxNQUFjLEVBQ2QsSUFBZ0IsRUFDZixPQUFzQjtRQUZ2QixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUNmLFlBQU8sR0FBUCxPQUFPLENBQWU7SUFDMUIsQ0FBQztJQUdFLGVBQWU7UUFDckIsY0FBYyxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUMzQyxjQUFjLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ25DLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFTSxhQUFhLENBQUMsVUFBYztRQUVqQyxJQUFJLFlBQVksR0FBRSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3JGLElBQUksWUFBWSxHQUFHLFFBQVEsQ0FBQyxVQUFVLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDNUYsSUFBSSxPQUFPLEdBQUcsRUFBRSxjQUFjLEVBQUUsWUFBWSxFQUFFLGVBQWUsRUFBRSxZQUFZLEVBQUUsQ0FBQztR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QU8sYUFBYSxDQUFDLGVBQWUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxhQUFhLENBQUMsZUFBZSxDQUFDLElBQUksU0FBUztvQkFDeEYsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUM7b0JBQ2hDLENBQUMsQ0FBQyxZQUFZLENBQUM7YUFDakI7aUJBQU07Z0JBQ0wsT0FBTyxZQUFZLENBQUM7YUFDdEI7U0FDRDthQUFNO1lBQ0wsT0FBTyxZQUFZLENBQUM7U0FDckI7SUFDSixDQUFDOztpSEFqUFcsbUJBQW1CO3FIQUFuQixtQkFBbUIsY0FGbEIsTUFBTTs0RkFFUCxtQkFBbUI7a0JBSC9CLFVBQVU7bUJBQUM7b0JBQ1YsVUFBVSxFQUFFLE1BQU07aUJBQ25CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQgeyBCZWhhdmlvclN1YmplY3QsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCAqIGFzIENyeXB0b0pTIGZyb20gJ2NyeXB0by1qcyc7XG5cbmltcG9ydCB7QnVmZmVyfSBmcm9tICdidWZmZXInO1xuaW1wb3J0IHsgVmFybGlzdFNlcnZpY2UgfSBmcm9tICcuL3Zhcmxpc3Quc2VydmljZSc7XG5cblxuXG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIE1zZ2VuZ2luZUxpYlNlcnZpY2Uge1xuXG5cblxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsIFxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcbiAgICAgcHJpdmF0ZSB2YXJsaXN0OlZhcmxpc3RTZXJ2aWNlXG4gICAgICkgeyB9XG5cblxuICAgICBwdWJsaWMgZGlyZWN0bG9nb3V0bGliKCl7XG4gICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCdBRE1JTl9TRVNTSU9OJyk7XG4gICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCdUT0tFTicpO1xuICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGVCeVVybCgnL2xvZ2luJyk7XG4gIH1cblxuICBwdWJsaWMgZ2V0R2V0d2F5TmFtZShmb3JtUGFyYW1zOmFueSk6T2JzZXJ2YWJsZTxhbnk+IHtcblxuICAgIGxldCByZXF1ZXN0UGFyYW0gPUJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KGZvcm1QYXJhbXMpLCAndXRmOCcpLnRvU3RyaW5nKCdiYXNlNjQnKTtcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xuICAgIGxldCByZXFEYXRhID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9O1xuICAgIGxldCBzZXJ2aWNlVVJMID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL2dldHdheUNvbmZpZ3VyYXRpb24nO1xuICAgIGxldCBkZXNuUmVzcG9uc2UgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVVJMLCByZXFEYXRhKTtcbiAgICByZXR1cm4gZGVzblJlc3BvbnNlO1xuIFxuICB9XG5cblxuXG4gIHB1YmxpYyB2aWV3R2F0d2F5VHlwZXMoZm9ybVBhcmFtczphbnkpOk9ic2VydmFibGU8YW55PiB7XG5cbiAgICBsZXQgcmVxdWVzdFBhcmFtID1CdWZmZXIuZnJvbShKU09OLnN0cmluZ2lmeShmb3JtUGFyYW1zKSwgJ3V0ZjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICBsZXQgcmVxRGF0YSA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfTtcbiAgICBsZXQgc2VydmljZVVSTCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJy9nZXR3YXlUeXBlJztcbiAgICBsZXQgZGVzblJlc3BvbnNlID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVSTCwgcmVxRGF0YSk7XG4gICAgcmV0dXJuIGRlc25SZXNwb25zZTtcbiBcbiAgfVxuXG5cbiAgbmV3R2V0d2F5Q29uZmlnKGRvY1BhcmFtczphbnkpOk9ic2VydmFibGU8YW55PntcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShkb2NQYXJhbXMpKTtcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xuICAgIGxldCByZXFEYXRhID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9O1xuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwrJy9pbnNlcnRHYXRld2F5Q29uZmlndXJhdGlvbic7XG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLHJlcURhdGEpO1xuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xuICB9XG5cblxuICAgdmlld0dldHdheUNvbmZpZyhkb2NQYXJhbXM6YW55KTpPYnNlcnZhYmxlPGFueT57XG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkoZG9jUGFyYW1zKSk7XG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICBsZXQgcmVxRGF0YSA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfTtcbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMKycvdmlld0NvbmZpZ3VyYXRpb24nO1xuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCxyZXFEYXRhKTtcbiAgICByZXR1cm4gc2VydmljZVJlcztcbiAgfVxuICBnZXRQcmV2RGV0YWlscyhkb2NQYXJhbXM6YW55KTpPYnNlcnZhYmxlPGFueT57XG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkoZG9jUGFyYW1zKSk7XG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICBsZXQgcmVxRGF0YSA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfTtcbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMKycvZmlsbEFsbCc7XG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLHJlcURhdGEpO1xuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xuXG4gIH1cblxuICBkZWxldGVHZXR3YXlDb25maWcoZG9jUGFyYW1zOmFueSk6T2JzZXJ2YWJsZTxhbnk+e1xuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KGRvY1BhcmFtcykpO1xuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XG4gICAgbGV0IHJlcURhdGEgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH07XG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCsnL2RlbGV0ZWdldHdheURvY3VtZW50JztcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwscmVxRGF0YSk7XG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XG4gIH1cblxuICBkZWxldGVBbGwoZm9ybVBhcmFtcyA6IGFueSwgZm5hbWUgOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KGZvcm1QYXJhbXMpKTtcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xuICAgIGxldCByZXFEYXRhID0ge1xuICAgICAgUkVRVUVTVF9EQVRBOiByZXF1ZXN0UGFyYW0sXG4gICAgICBSRVFVRVNUX1RPS0VOOiByZXF1ZXN0VG9rZW5cbiAgICB9O1xuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyBmbmFtZTtcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIHJlcURhdGEpO1xuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xuICB9XG4gIHB1Ymxpc2hBbGwoZm9ybVBhcmFtcyA6IGFueSwgZm5hbWUgOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KGZvcm1QYXJhbXMpKTtcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xuICAgIGxldCByZXFEYXRhID0ge1xuICAgICAgUkVRVUVTVF9EQVRBOiByZXF1ZXN0UGFyYW0sXG4gICAgICBSRVFVRVNUX1RPS0VOOiByZXF1ZXN0VG9rZW5cbiAgICB9O1xuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyBmbmFtZTtcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIHJlcURhdGEpO1xuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xuICB9XG4gIHVucHVibGlzaEFsbChmb3JtUGFyYW1zIDogYW55LCBmbmFtZSA6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkoZm9ybVBhcmFtcykpO1xuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XG4gICAgbGV0IHJlcURhdGEgPSB7XG4gICAgICBSRVFVRVNUX0RBVEE6IHJlcXVlc3RQYXJhbSxcbiAgICAgIFJFUVVFU1RfVE9LRU46IHJlcXVlc3RUb2tlblxuICAgIH07XG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArIGZuYW1lO1xuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgcmVxRGF0YSk7XG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XG4gIH1cblxuICAgbmV3TWVzc2FnZShtZXNzYWdlUGFyYW1zOmFueSk6T2JzZXJ2YWJsZTxhbnk+e1xuICAgICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkobWVzc2FnZVBhcmFtcykpO1xuICAgICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICAgIGxldCByZXFEYXRhID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9O1xuICAgICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCsnL2FkZE1lc3NhZ2VDb25maWcnO1xuICAgICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLHJlcURhdGEpO1xuICAgICAgcmV0dXJuIHNlcnZpY2VSZXM7XG4gICAgfVxuICAvLyBuZXdNZXNzYWdlKG1lc3NhZ2VQYXJhbXM6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gIC8vICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArICdhZGRNZXNzYWdlQ29uZmlnJztcbiAgLy8gICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIG1lc3NhZ2VQYXJhbXMpO1xuICAvLyAgIHJldHVybiBzZXJ2aWNlUmVzO1xuICAvLyB9XG5cbiAgdmlld01lc3NhZ2UobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShtZXNzYWdlUGFyYW1zKSk7XG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArICcvdmlld01lc3NhZ2VDb25maWcnO1xuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgbWVzc2FnZVBhcmFtcyk7XG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XG4gIH1cbiAgcmVtaW5kZXJTY2hlZHVsYXIobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShtZXNzYWdlUGFyYW1zKSk7XG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArICcvZ2V0UmVtaW5kZXJjcm9uJztcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIG1lc3NhZ2VQYXJhbXMpO1xuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xuICB9XG4gIG1zZ2V4ZWN1dGVTY2hlZHVsYXIobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShtZXNzYWdlUGFyYW1zKSk7XG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArICcvc3RhcnRFeGVjdXRpb24nO1xuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgbWVzc2FnZVBhcmFtcyk7XG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XG4gIH1cbiAgbXNnc3RvcFNjaGVkdWxhcihtZXNzYWdlUGFyYW1zOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xuICAgIG1lc3NhZ2VQYXJhbXMgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH1cbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJy9zdG9wRXhlY3V0aW9uJztcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIG1lc3NhZ2VQYXJhbXMpO1xuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xuICB9XG5cbiAgZ2V0U3RhdGljQ29uZmlndXJhdGlvbktleXMobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShtZXNzYWdlUGFyYW1zKSk7XG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArICcvR2V0U3RhdGljS2V5cyc7XG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLCBtZXNzYWdlUGFyYW1zKTtcbiAgICByZXR1cm4gc2VydmljZVJlcztcbiAgfVxuICBcblxuICBnZXRGZXRjaFB1Ymxpc2hSZWNvcmQobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShtZXNzYWdlUGFyYW1zKSk7XG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArICcvRmV0Y2hQdWJsaXNoUmVjb3JkJztcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIG1lc3NhZ2VQYXJhbXMpO1xuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xuICB9XG5cblxuICBnZXRMYW5ndWFnZShtZXNzYWdlUGFyYW1zOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xuICAgIG1lc3NhZ2VQYXJhbXMgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH1cbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJy92aWV3TGFuZ3VhZ2UnO1xuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgbWVzc2FnZVBhcmFtcyk7XG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XG4gIH1cblxuICBnZXRGb3JtcyhtZXNzYWdlUGFyYW1zOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xuICAgIG1lc3NhZ2VQYXJhbXMgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH1cbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJy9nZXRGb3JtTmFtZSc7XG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLCBtZXNzYWdlUGFyYW1zKTtcbiAgICByZXR1cm4gc2VydmljZVJlcztcbiAgfVxuXG4gIGdldENvbmZpZ3VyYXRpb25LZXlzKG1lc3NhZ2VQYXJhbXM6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkobWVzc2FnZVBhcmFtcykpO1xuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XG4gICAgbWVzc2FnZVBhcmFtcyA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfVxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL2dldENvbmZpZ0tleXMnO1xuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgbWVzc2FnZVBhcmFtcyk7XG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XG4gIH1cblxuXG5cbiAgcHVibGljIG1zZ3VwbG9hZEZpbGUoZm9ybVBhcmFtczphbnkpOk9ic2VydmFibGU8YW55PiB7XG4gICAgbGV0IHNlcnZpY2VVUkwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArICcvZmlsZVVwbG9hZCc7XG4gICAgbGV0IG1vZHVsZVJlc3BvbnNlID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVSTCwgZm9ybVBhcmFtcyk7XG4gICAgcmV0dXJuIG1vZHVsZVJlc3BvbnNlO1xuICB9XG5cblxuXG4gIGxhbmdSZXBsYWNlKGxhbmd1YWdlVGV4dCA6IGFueSwgbGFuZ3VhZ2VOYW1lIDogYW55ID0gXCJcIikge1xuICAgIGlmIChsYW5ndWFnZVRleHQgIT0gXCJcIiAmJiBsYW5ndWFnZVRleHQgIT11bmRlZmluZWQpIHtcbiAgICAgIGxldCBsbmdUb0xvd2VyOiBhbnkgPSBsYW5ndWFnZVRleHQudG9Mb3dlckNhc2UoKTtcblxuICAgICBsZXQgYWxsTGFuZ0xpc3RSZXN1bHQ6IGFueSA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oXCJBTExfTEFOR19MSVNUXCIpO1xuXG4gICAgbGV0IFNlZXRpb25QYXJzZWRMYW5nUmVzID0gSlNPTi5wYXJzZShDcnlwdG9KUy5BRVMuZGVjcnlwdChhbGxMYW5nTGlzdFJlc3VsdCwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKENyeXB0b0pTLmVuYy5VdGY4KSk7XG5cbiAgICAgbGV0IHNlc3Npb25Vc2VyTGFuZ3Rva2VuOiBhbnkgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKFwiVVNFUl9MQU5HUFJFRlwiKTtcblxuICAgICBsZXQgc2Vzc2lvblVzZXJMYW5nID0gSlNPTi5wYXJzZShDcnlwdG9KUy5BRVMuZGVjcnlwdChzZXNzaW9uVXNlckxhbmd0b2tlbiwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKENyeXB0b0pTLmVuYy5VdGY4KSk7XG5cbiAgICAgIGlmIChTZWV0aW9uUGFyc2VkTGFuZ1Jlc1tsbmdUb0xvd2VyXSAhPSB1bmRlZmluZWQpIHtcbiAgICAgICBsZXQgYWxsUGFyc2VkTGFuZyA9IEpTT04ucGFyc2UoU2VldGlvblBhcnNlZExhbmdSZXNbbG5nVG9Mb3dlcl0pO1xuICAgICAgIHJldHVybiBhbGxQYXJzZWRMYW5nW3Nlc3Npb25Vc2VyTGFuZ10gIT0gXCJcIiAmJiBhbGxQYXJzZWRMYW5nW3Nlc3Npb25Vc2VyTGFuZ10gIT0gdW5kZWZpbmVkXG4gICAgICAgICA/IGFsbFBhcnNlZExhbmdbc2Vzc2lvblVzZXJMYW5nXVxuICAgICAgICAgOiBsYW5ndWFnZVRleHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbGFuZ3VhZ2VUZXh0O1xuICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBsYW5ndWFnZVRleHQ7XG4gICAgfVxuIH1cblxufVxuIl19