import { Injectable } from '@angular/core';
import * as CryptoJS from 'crypto-js';
import { Buffer } from 'buffer';
import Swal from 'sweetalert2';
import * as i0 from "@angular/core";
import * as i1 from "@angular/router";
import * as i2 from "@angular/common/http";
import * as i3 from "./varlist.service";
export class MsgengineLibService {
    constructor(router, http, varlist) {
        this.router = router;
        this.http = http;
        this.varlist = varlist;
    }
    directlogoutlib() {
        sessionStorage.removeItem('ADMIN_SESSION');
        sessionStorage.removeItem('TOKEN');
        this.router.navigateByUrl('/login');
    }
    getGetwayName(formParams) {
        let requestParam = Buffer.from(JSON.stringify(formParams), 'utf8').toString('base64');
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceURL = this.varlist.serviceURL + '/getwayConfiguration';
        let desnResponse = this.http.post(serviceURL, reqData);
        return desnResponse;
    }
    viewGatwayTypes(formParams) {
        let requestParam = Buffer.from(JSON.stringify(formParams), 'utf8').toString('base64');
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceURL = this.varlist.serviceURL + '/getwayType';
        let desnResponse = this.http.post(serviceURL, reqData);
        return desnResponse;
    }
    newGetwayConfig(docParams) {
        let requestParam = btoa(JSON.stringify(docParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/insertGatewayConfiguration';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    viewGetwayConfig(docParams) {
        let requestParam = btoa(JSON.stringify(docParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/viewConfiguration';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    getPrevDetails(docParams) {
        let requestParam = btoa(JSON.stringify(docParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/fillAll';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    deleteGetwayConfig(docParams) {
        let requestParam = btoa(JSON.stringify(docParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/deletegetwayDocument';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    deleteAll(formParams, fname) {
        let requestParam = btoa(JSON.stringify(formParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = {
            REQUEST_DATA: requestParam,
            REQUEST_TOKEN: requestToken
        };
        let serviceUrl = this.varlist.serviceURL + fname;
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    publishAll(formParams, fname) {
        let requestParam = btoa(JSON.stringify(formParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = {
            REQUEST_DATA: requestParam,
            REQUEST_TOKEN: requestToken
        };
        let serviceUrl = this.varlist.serviceURL + fname;
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    unpublishAll(formParams, fname) {
        let requestParam = btoa(JSON.stringify(formParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = {
            REQUEST_DATA: requestParam,
            REQUEST_TOKEN: requestToken
        };
        let serviceUrl = this.varlist.serviceURL + fname;
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    newMessage(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        let reqData = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/addMessageConfig';
        let serviceRes = this.http.post(serviceUrl, reqData);
        return serviceRes;
    }
    // newMessage(messageParams: any): Observable<any> {
    //   let serviceUrl = this.varlist.serviceURL + 'addMessageConfig';
    //   let serviceRes = this.http.post(serviceUrl, messageParams);
    //   return serviceRes;
    // }
    viewMessage(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/viewMessageConfig';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    reminderSchedular(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/getRemindercron';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    msgexecuteSchedular(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/startExecution';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    msgstopSchedular(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/stopExecution';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getStaticConfigurationKeys(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/GetStaticKeys';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getFetchPublishRecord(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/FetchPublishRecord';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getLanguage(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/viewLanguage';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getForms(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/getFormName';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    getConfigurationKeys(messageParams) {
        let requestParam = btoa(JSON.stringify(messageParams));
        let requestToken = CryptoJS.HmacSHA256(requestParam, this.varlist.apiHashingKey).toString();
        messageParams = { 'REQUEST_DATA': requestParam, 'REQUEST_TOKEN': requestToken };
        let serviceUrl = this.varlist.serviceURL + '/getConfigKeys';
        let serviceRes = this.http.post(serviceUrl, messageParams);
        return serviceRes;
    }
    msguploadFile(formParams) {
        let serviceURL = this.varlist.serviceURL + '/fileUpload';
        let moduleResponse = this.http.post(serviceURL, formParams);
        return moduleResponse;
    }
    langReplace(languageText, languageName = "") {
        if (languageText != "" && languageText != undefined) {
            let lngToLower = languageText.toLowerCase();
            let allLangListResult = sessionStorage.getItem("ALL_LANG_LIST");
            let SeetionParsedLangRes = JSON.parse(CryptoJS.AES.decrypt(allLangListResult, this.varlist.apiHashingKey).toString(CryptoJS.enc.Utf8));
            let sessionUserLangtoken = sessionStorage.getItem("USER_LANGPREF");
            let sessionUserLang = JSON.parse(CryptoJS.AES.decrypt(sessionUserLangtoken, this.varlist.apiHashingKey).toString(CryptoJS.enc.Utf8));
            if (SeetionParsedLangRes[lngToLower] != undefined) {
                let allParsedLang = JSON.parse(SeetionParsedLangRes[lngToLower]);
                return allParsedLang[sessionUserLang] != "" && allParsedLang[sessionUserLang] != undefined
                    ? allParsedLang[sessionUserLang]
                    : languageText;
            }
            else {
                return languageText;
            }
        }
        else {
            return languageText;
        }
    }
    swalfire(type, message) {
        return Swal.fire({
            icon: type,
            text: message
        });
    }
}
MsgengineLibService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: MsgengineLibService, deps: [{ token: i1.Router }, { token: i2.HttpClient }, { token: i3.VarlistService }], target: i0.ɵɵFactoryTarget.Injectable });
MsgengineLibService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: MsgengineLibService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: MsgengineLibService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: function () { return [{ type: i1.Router }, { type: i2.HttpClient }, { type: i3.VarlistService }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXNnZW5naW5lLWxpYi5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbXNnZW5naW5lLWxpYi9zcmMvbGliL21zZ2VuZ2luZS1saWIuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBSzNDLE9BQU8sS0FBSyxRQUFRLE1BQU0sV0FBVyxDQUFDO0FBRXRDLE9BQU8sRUFBQyxNQUFNLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFFOUIsT0FBTyxJQUFJLE1BQU0sYUFBYSxDQUFDOzs7OztBQVEvQixNQUFNLE9BQU8sbUJBQW1CO0lBSzlCLFlBQ1UsTUFBYyxFQUNkLElBQWdCLEVBQ2YsT0FBc0I7UUFGdkIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLFNBQUksR0FBSixJQUFJLENBQVk7UUFDZixZQUFPLEdBQVAsT0FBTyxDQUFlO0lBQzFCLENBQUM7SUFHRSxlQUFlO1FBQ3JCLGNBQWMsQ0FBQyxVQUFVLENBQUMsZUFBZSxDQUFDLENBQUM7UUFDM0MsY0FBYyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNuQyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBRU0sYUFBYSxDQUFDLFVBQWM7UUFFakMsSUFBSSxZQUFZLEdBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNyRixJQUFJLFlBQVksR0FBRyxRQUFRLENBQUMsVUFBVSxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQzVGLElBQUksT0FBTyxHQUFHLEVBQUUsY0FBYyxFQUFFLFlBQVks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QyxVQUFVLENBQUMsQ0FBQyxDQUFDO2dCQUNqRSxPQUFPLGFBQWEsQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUFFLElBQUksYUFBYSxDQUFDLGVBQWUsQ0FBQyxJQUFJLFNBQVM7b0JBQ3hGLENBQUMsQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDO29CQUNoQyxDQUFDLENBQUMsWUFBWSxDQUFDO2FBQ2pCO2lCQUFNO2dCQUNMLE9BQU8sWUFBWSxDQUFDO2FBQ3RCO1NBQ0Q7YUFBTTtZQUNMLE9BQU8sWUFBWSxDQUFDO1NBQ3JCO0lBQ0osQ0FBQztJQUdELFFBQVEsQ0FBQyxJQUFTLEVBQUUsT0FBWTtRQUMvQixPQUFRLElBQUksQ0FBQyxJQUFJLENBQUM7WUFDVCxJQUFJLEVBQUUsSUFBSTtZQUNWLElBQUksRUFBRSxPQUFPO1NBQ1osQ0FBQyxDQUFDO0lBRWIsQ0FBQzs7aUhBMVBXLG1CQUFtQjtxSEFBbkIsbUJBQW1CLGNBRmxCLE1BQU07NEZBRVAsbUJBQW1CO2tCQUgvQixVQUFVO21CQUFDO29CQUNWLFVBQVUsRUFBRSxNQUFNO2lCQUNuQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcclxuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0ICogYXMgQ3J5cHRvSlMgZnJvbSAnY3J5cHRvLWpzJztcclxuXHJcbmltcG9ydCB7QnVmZmVyfSBmcm9tICdidWZmZXInO1xyXG5pbXBvcnQgeyBWYXJsaXN0U2VydmljZSB9IGZyb20gJy4vdmFybGlzdC5zZXJ2aWNlJztcclxuaW1wb3J0IFN3YWwgZnJvbSAnc3dlZXRhbGVydDInO1xyXG5cclxuXHJcblxyXG5cclxuQEluamVjdGFibGUoe1xyXG4gIHByb3ZpZGVkSW46ICdyb290J1xyXG59KVxyXG5leHBvcnQgY2xhc3MgTXNnZW5naW5lTGliU2VydmljZSB7XHJcblxyXG5cclxuXHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlciwgXHJcbiAgICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQsXHJcbiAgICAgcHJpdmF0ZSB2YXJsaXN0OlZhcmxpc3RTZXJ2aWNlXHJcbiAgICAgKSB7IH1cclxuXHJcblxyXG4gICAgIHB1YmxpYyBkaXJlY3Rsb2dvdXRsaWIoKXtcclxuICAgICAgc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgnQURNSU5fU0VTU0lPTicpO1xyXG4gICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCdUT0tFTicpO1xyXG4gICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZUJ5VXJsKCcvbG9naW4nKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBnZXRHZXR3YXlOYW1lKGZvcm1QYXJhbXM6YW55KTpPYnNlcnZhYmxlPGFueT4ge1xyXG5cclxuICAgIGxldCByZXF1ZXN0UGFyYW0gPUJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KGZvcm1QYXJhbXMpLCAndXRmOCcpLnRvU3RyaW5nKCdiYXNlNjQnKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBsZXQgcmVxRGF0YSA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfTtcclxuICAgIGxldCBzZXJ2aWNlVVJMID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL2dldHdheUNvbmZpZ3VyYXRpb24nO1xyXG4gICAgbGV0IGRlc25SZXNwb25zZSA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVUkwsIHJlcURhdGEpO1xyXG4gICAgcmV0dXJuIGRlc25SZXNwb25zZTtcclxuIFxyXG4gIH1cclxuXHJcblxyXG5cclxuICBwdWJsaWMgdmlld0dhdHdheVR5cGVzKGZvcm1QYXJhbXM6YW55KTpPYnNlcnZhYmxlPGFueT4ge1xyXG5cclxuICAgIGxldCByZXF1ZXN0UGFyYW0gPUJ1ZmZlci5mcm9tKEpTT04uc3RyaW5naWZ5KGZvcm1QYXJhbXMpLCAndXRmOCcpLnRvU3RyaW5nKCdiYXNlNjQnKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBsZXQgcmVxRGF0YSA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfTtcclxuICAgIGxldCBzZXJ2aWNlVVJMID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL2dldHdheVR5cGUnO1xyXG4gICAgbGV0IGRlc25SZXNwb25zZSA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVUkwsIHJlcURhdGEpO1xyXG4gICAgcmV0dXJuIGRlc25SZXNwb25zZTtcclxuIFxyXG4gIH1cclxuXHJcblxyXG4gIG5ld0dldHdheUNvbmZpZyhkb2NQYXJhbXM6YW55KTpPYnNlcnZhYmxlPGFueT57XHJcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShkb2NQYXJhbXMpKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBsZXQgcmVxRGF0YSA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfTtcclxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwrJy9pbnNlcnRHYXRld2F5Q29uZmlndXJhdGlvbic7XHJcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwscmVxRGF0YSk7XHJcbiAgICByZXR1cm4gc2VydmljZVJlcztcclxuICB9XHJcblxyXG5cclxuICAgdmlld0dldHdheUNvbmZpZyhkb2NQYXJhbXM6YW55KTpPYnNlcnZhYmxlPGFueT57XHJcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShkb2NQYXJhbXMpKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBsZXQgcmVxRGF0YSA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfTtcclxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwrJy92aWV3Q29uZmlndXJhdGlvbic7XHJcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwscmVxRGF0YSk7XHJcbiAgICByZXR1cm4gc2VydmljZVJlcztcclxuICB9XHJcbiAgZ2V0UHJldkRldGFpbHMoZG9jUGFyYW1zOmFueSk6T2JzZXJ2YWJsZTxhbnk+e1xyXG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkoZG9jUGFyYW1zKSk7XHJcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xyXG4gICAgbGV0IHJlcURhdGEgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH07XHJcbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMKycvZmlsbEFsbCc7XHJcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwscmVxRGF0YSk7XHJcbiAgICByZXR1cm4gc2VydmljZVJlcztcclxuXHJcbiAgfVxyXG5cclxuICBkZWxldGVHZXR3YXlDb25maWcoZG9jUGFyYW1zOmFueSk6T2JzZXJ2YWJsZTxhbnk+e1xyXG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkoZG9jUGFyYW1zKSk7XHJcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xyXG4gICAgbGV0IHJlcURhdGEgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH07XHJcbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMKycvZGVsZXRlZ2V0d2F5RG9jdW1lbnQnO1xyXG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLHJlcURhdGEpO1xyXG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XHJcbiAgfVxyXG5cclxuICBkZWxldGVBbGwoZm9ybVBhcmFtcyA6IGFueSwgZm5hbWUgOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkoZm9ybVBhcmFtcykpO1xyXG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcclxuICAgIGxldCByZXFEYXRhID0ge1xyXG4gICAgICBSRVFVRVNUX0RBVEE6IHJlcXVlc3RQYXJhbSxcclxuICAgICAgUkVRVUVTVF9UT0tFTjogcmVxdWVzdFRva2VuXHJcbiAgICB9O1xyXG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArIGZuYW1lO1xyXG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLCByZXFEYXRhKTtcclxuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xyXG4gIH1cclxuICBwdWJsaXNoQWxsKGZvcm1QYXJhbXMgOiBhbnksIGZuYW1lIDogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KGZvcm1QYXJhbXMpKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBsZXQgcmVxRGF0YSA9IHtcclxuICAgICAgUkVRVUVTVF9EQVRBOiByZXF1ZXN0UGFyYW0sXHJcbiAgICAgIFJFUVVFU1RfVE9LRU46IHJlcXVlc3RUb2tlblxyXG4gICAgfTtcclxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyBmbmFtZTtcclxuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgcmVxRGF0YSk7XHJcbiAgICByZXR1cm4gc2VydmljZVJlcztcclxuICB9XHJcbiAgdW5wdWJsaXNoQWxsKGZvcm1QYXJhbXMgOiBhbnksIGZuYW1lIDogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KGZvcm1QYXJhbXMpKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBsZXQgcmVxRGF0YSA9IHtcclxuICAgICAgUkVRVUVTVF9EQVRBOiByZXF1ZXN0UGFyYW0sXHJcbiAgICAgIFJFUVVFU1RfVE9LRU46IHJlcXVlc3RUb2tlblxyXG4gICAgfTtcclxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyBmbmFtZTtcclxuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgcmVxRGF0YSk7XHJcbiAgICByZXR1cm4gc2VydmljZVJlcztcclxuICB9XHJcblxyXG4gICBuZXdNZXNzYWdlKG1lc3NhZ2VQYXJhbXM6YW55KTpPYnNlcnZhYmxlPGFueT57XHJcbiAgICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcclxuICAgICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcclxuICAgICAgbGV0IHJlcURhdGEgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH07XHJcbiAgICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwrJy9hZGRNZXNzYWdlQ29uZmlnJztcclxuICAgICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLHJlcURhdGEpO1xyXG4gICAgICByZXR1cm4gc2VydmljZVJlcztcclxuICAgIH1cclxuICAvLyBuZXdNZXNzYWdlKG1lc3NhZ2VQYXJhbXM6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgLy8gICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJ2FkZE1lc3NhZ2VDb25maWcnO1xyXG4gIC8vICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLCBtZXNzYWdlUGFyYW1zKTtcclxuICAvLyAgIHJldHVybiBzZXJ2aWNlUmVzO1xyXG4gIC8vIH1cclxuXHJcbiAgdmlld01lc3NhZ2UobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XHJcbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJy92aWV3TWVzc2FnZUNvbmZpZyc7XHJcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIG1lc3NhZ2VQYXJhbXMpO1xyXG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XHJcbiAgfVxyXG4gIHJlbWluZGVyU2NoZWR1bGFyKG1lc3NhZ2VQYXJhbXM6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XHJcbiAgICBsZXQgcmVxdWVzdFBhcmFtID0gYnRvYShKU09OLnN0cmluZ2lmeShtZXNzYWdlUGFyYW1zKSk7XHJcbiAgICBsZXQgcmVxdWVzdFRva2VuID0gQ3J5cHRvSlMuSG1hY1NIQTI1NihyZXF1ZXN0UGFyYW0sIHRoaXMudmFybGlzdC5hcGlIYXNoaW5nS2V5KS50b1N0cmluZygpO1xyXG4gICAgbWVzc2FnZVBhcmFtcyA9IHsgJ1JFUVVFU1RfREFUQSc6IHJlcXVlc3RQYXJhbSwgJ1JFUVVFU1RfVE9LRU4nOiByZXF1ZXN0VG9rZW4gfVxyXG4gICAgbGV0IHNlcnZpY2VVcmwgPSB0aGlzLnZhcmxpc3Quc2VydmljZVVSTCArICcvZ2V0UmVtaW5kZXJjcm9uJztcclxuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgbWVzc2FnZVBhcmFtcyk7XHJcbiAgICByZXR1cm4gc2VydmljZVJlcztcclxuICB9XHJcbiAgbXNnZXhlY3V0ZVNjaGVkdWxhcihtZXNzYWdlUGFyYW1zOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkobWVzc2FnZVBhcmFtcykpO1xyXG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcclxuICAgIG1lc3NhZ2VQYXJhbXMgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH1cclxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL3N0YXJ0RXhlY3V0aW9uJztcclxuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgbWVzc2FnZVBhcmFtcyk7XHJcbiAgICByZXR1cm4gc2VydmljZVJlcztcclxuICB9XHJcbiAgbXNnc3RvcFNjaGVkdWxhcihtZXNzYWdlUGFyYW1zOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkobWVzc2FnZVBhcmFtcykpO1xyXG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcclxuICAgIG1lc3NhZ2VQYXJhbXMgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH1cclxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL3N0b3BFeGVjdXRpb24nO1xyXG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLCBtZXNzYWdlUGFyYW1zKTtcclxuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xyXG4gIH1cclxuXHJcbiAgZ2V0U3RhdGljQ29uZmlndXJhdGlvbktleXMobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XHJcbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJy9HZXRTdGF0aWNLZXlzJztcclxuICAgIGxldCBzZXJ2aWNlUmVzID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVybCwgbWVzc2FnZVBhcmFtcyk7XHJcbiAgICByZXR1cm4gc2VydmljZVJlcztcclxuICB9XHJcbiAgXHJcblxyXG4gIGdldEZldGNoUHVibGlzaFJlY29yZChtZXNzYWdlUGFyYW1zOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkobWVzc2FnZVBhcmFtcykpO1xyXG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcclxuICAgIG1lc3NhZ2VQYXJhbXMgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH1cclxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL0ZldGNoUHVibGlzaFJlY29yZCc7XHJcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIG1lc3NhZ2VQYXJhbXMpO1xyXG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XHJcbiAgfVxyXG5cclxuXHJcbiAgZ2V0TGFuZ3VhZ2UobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XHJcbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJy92aWV3TGFuZ3VhZ2UnO1xyXG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLCBtZXNzYWdlUGFyYW1zKTtcclxuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xyXG4gIH1cclxuXHJcbiAgZ2V0Rm9ybXMobWVzc2FnZVBhcmFtczogYW55KTogT2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCByZXF1ZXN0UGFyYW0gPSBidG9hKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcclxuICAgIGxldCByZXF1ZXN0VG9rZW4gPSBDcnlwdG9KUy5IbWFjU0hBMjU2KHJlcXVlc3RQYXJhbSwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKCk7XHJcbiAgICBtZXNzYWdlUGFyYW1zID0geyAnUkVRVUVTVF9EQVRBJzogcmVxdWVzdFBhcmFtLCAnUkVRVUVTVF9UT0tFTic6IHJlcXVlc3RUb2tlbiB9XHJcbiAgICBsZXQgc2VydmljZVVybCA9IHRoaXMudmFybGlzdC5zZXJ2aWNlVVJMICsgJy9nZXRGb3JtTmFtZSc7XHJcbiAgICBsZXQgc2VydmljZVJlcyA9IHRoaXMuaHR0cC5wb3N0KHNlcnZpY2VVcmwsIG1lc3NhZ2VQYXJhbXMpO1xyXG4gICAgcmV0dXJuIHNlcnZpY2VSZXM7XHJcbiAgfVxyXG5cclxuICBnZXRDb25maWd1cmF0aW9uS2V5cyhtZXNzYWdlUGFyYW1zOiBhbnkpOiBPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgbGV0IHJlcXVlc3RQYXJhbSA9IGJ0b2EoSlNPTi5zdHJpbmdpZnkobWVzc2FnZVBhcmFtcykpO1xyXG4gICAgbGV0IHJlcXVlc3RUb2tlbiA9IENyeXB0b0pTLkhtYWNTSEEyNTYocmVxdWVzdFBhcmFtLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoKTtcclxuICAgIG1lc3NhZ2VQYXJhbXMgPSB7ICdSRVFVRVNUX0RBVEEnOiByZXF1ZXN0UGFyYW0sICdSRVFVRVNUX1RPS0VOJzogcmVxdWVzdFRva2VuIH1cclxuICAgIGxldCBzZXJ2aWNlVXJsID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL2dldENvbmZpZ0tleXMnO1xyXG4gICAgbGV0IHNlcnZpY2VSZXMgPSB0aGlzLmh0dHAucG9zdChzZXJ2aWNlVXJsLCBtZXNzYWdlUGFyYW1zKTtcclxuICAgIHJldHVybiBzZXJ2aWNlUmVzO1xyXG4gIH1cclxuXHJcblxyXG5cclxuICBwdWJsaWMgbXNndXBsb2FkRmlsZShmb3JtUGFyYW1zOmFueSk6T2JzZXJ2YWJsZTxhbnk+IHtcclxuICAgIGxldCBzZXJ2aWNlVVJMID0gdGhpcy52YXJsaXN0LnNlcnZpY2VVUkwgKyAnL2ZpbGVVcGxvYWQnO1xyXG4gICAgbGV0IG1vZHVsZVJlc3BvbnNlID0gdGhpcy5odHRwLnBvc3Qoc2VydmljZVVSTCwgZm9ybVBhcmFtcyk7XHJcbiAgICByZXR1cm4gbW9kdWxlUmVzcG9uc2U7XHJcbiAgfVxyXG5cclxuXHJcblxyXG4gIGxhbmdSZXBsYWNlKGxhbmd1YWdlVGV4dCA6IGFueSwgbGFuZ3VhZ2VOYW1lIDogYW55ID0gXCJcIikge1xyXG4gICAgaWYgKGxhbmd1YWdlVGV4dCAhPSBcIlwiICYmIGxhbmd1YWdlVGV4dCAhPXVuZGVmaW5lZCkge1xyXG4gICAgICBsZXQgbG5nVG9Mb3dlcjogYW55ID0gbGFuZ3VhZ2VUZXh0LnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgIGxldCBhbGxMYW5nTGlzdFJlc3VsdDogYW55ID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcIkFMTF9MQU5HX0xJU1RcIik7XHJcblxyXG4gICAgbGV0IFNlZXRpb25QYXJzZWRMYW5nUmVzID0gSlNPTi5wYXJzZShDcnlwdG9KUy5BRVMuZGVjcnlwdChhbGxMYW5nTGlzdFJlc3VsdCwgdGhpcy52YXJsaXN0LmFwaUhhc2hpbmdLZXkpLnRvU3RyaW5nKENyeXB0b0pTLmVuYy5VdGY4KSk7XHJcblxyXG4gICAgIGxldCBzZXNzaW9uVXNlckxhbmd0b2tlbjogYW55ID0gc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbShcIlVTRVJfTEFOR1BSRUZcIik7XHJcblxyXG4gICAgIGxldCBzZXNzaW9uVXNlckxhbmcgPSBKU09OLnBhcnNlKENyeXB0b0pTLkFFUy5kZWNyeXB0KHNlc3Npb25Vc2VyTGFuZ3Rva2VuLCB0aGlzLnZhcmxpc3QuYXBpSGFzaGluZ0tleSkudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLlV0ZjgpKTtcclxuXHJcbiAgICAgIGlmIChTZWV0aW9uUGFyc2VkTGFuZ1Jlc1tsbmdUb0xvd2VyXSAhPSB1bmRlZmluZWQpIHtcclxuICAgICAgIGxldCBhbGxQYXJzZWRMYW5nID0gSlNPTi5wYXJzZShTZWV0aW9uUGFyc2VkTGFuZ1Jlc1tsbmdUb0xvd2VyXSk7XHJcbiAgICAgICByZXR1cm4gYWxsUGFyc2VkTGFuZ1tzZXNzaW9uVXNlckxhbmddICE9IFwiXCIgJiYgYWxsUGFyc2VkTGFuZ1tzZXNzaW9uVXNlckxhbmddICE9IHVuZGVmaW5lZFxyXG4gICAgICAgICA/IGFsbFBhcnNlZExhbmdbc2Vzc2lvblVzZXJMYW5nXVxyXG4gICAgICAgICA6IGxhbmd1YWdlVGV4dDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbGFuZ3VhZ2VUZXh0O1xyXG4gICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJldHVybiBsYW5ndWFnZVRleHQ7XHJcbiAgICB9XHJcbiB9XHJcblxyXG5cclxuIHN3YWxmaXJlKHR5cGU6IGFueSwgbWVzc2FnZTogYW55KSB7XHJcbiAgcmV0dXJuICBTd2FsLmZpcmUoe1xyXG4gICAgICAgICAgIGljb246IHR5cGUsXHJcbiAgICAgICAgICAgdGV4dDogbWVzc2FnZVxyXG4gICAgICAgICAgIH0pO1xyXG4gXHJcbiB9XHJcblxyXG5cclxufVxyXG4iXX0=